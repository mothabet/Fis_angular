<div class="main-content p-4 main card reports-content" style="flex: 1;">
    <!-- header -->
    <div class="header d-flex flex-wrap justify-content-between align-items-center report-main-header">
        <h4 class="title">
            التقارير
        </h4>
        <div class="user d-flex justify-content-between align-items-center">
            <div class="dropdown">
                <button type="button" class="btn lang" id="dropdownlang" data-bs-toggle="dropdown"
                    aria-expanded="false">
                    <span class="current-lang">عربى</span>
                    <i class="fa-solid fa-chevron-down"></i>

                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownlang">
                    <li><a class="dropdown-item second-lang" href="#">En</a></li>
                </ul>
            </div>
            <i class="fa-solid fa-bell"></i>
            <div class="user-img">
                <img src="../../../../assets//images/avatar.PNG" class="img-fluid">
            </div>
        </div>
    </div>
    <!-- end-header -->
    <div class="header d-flex  justify-content-between align-items-center">
        <h4 class="">
            قائمة التقارير
        </h4>
        <div class="btns d-flex">

            <div class="d-flex flex-grow-1 gap-1 btns-group">

                <button type="button" class="btn btn-add add-report" data-bs-toggle="modal"
                    data-bs-target="#addReportDetails">
                    <i class="fa-solid fa-plus mx-1"></i>
                    إنشاء تفاصيل التقرير
                </button>

            </div>
        </div>
    </div>
    <!-- start content -->
    <div class="content companies report-table">
        <div class="header d-flex ">
            <h4 class="">
                جدول 1
            </h4>
            <div class="btns d-flex">

                <div class="d-flex flex-grow-1 gap-2 btns-group ">
                    <button type="button" class="btn btn-send trash">
                        <i class="fa-solid fa-trash"></i>
                        حذف
                    </button>

                    <button type="button" class="btn btn-accept">
                        <i class="fa-solid fa-pen"></i>
                        تعديل
                    </button>

                </div>
            </div>
        </div>
        <div>
            <div class="table-responsive company-table">
                <table class="table table-borderless">
                    <thead>
                        <tr class="t-header">
                            <th scope="col">رقم </th>
                            <th class="" scope="col">اسم التقرير
                            </th>
                            <th class="" scope="col">تفاصيل التقرير
                            </th>
                            <th class="" scope="col">تم إنشاءه
                            </th>

                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <input type="checkbox" name="Name1" id="Name1" disabled>
                                <label for="Name1">1 </label>

                            </td>
                            <td> تقرير X
                            </td>
                            <td>تفاصيل التقرير
                            </td>
                            <td>2024/04/20
                            </td>

                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<!--start add report modal -->
<div class="modal company-modal fade" id="addReportDetails" tabindex="-1" aria-labelledby="add" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-sm" style="min-width: 880px;">
        <div class="modal-content">
            <div class="modal-header pb-0">
                <h5 class="modal-title" id="add">إنشاء محتوى التقرير</h5>
            </div>
            <form>
                <div class="modal-body">
                    <div class="row">
                        <!-- First three fields on the same row -->
                        <div class="col-sm-4 mb-3 label-with-icon">
                            <input class="form-control input-modal" [(ngModel)]="report.part" type="text"
                                placeholder="اسم محتوى التقرير" name="reportPart">
                        </div>
                        <div class="col-sm-4"></div>
                        <div class="col-sm-4 mb-3">
                            <select [(ngModel)]="tableType" name="tableType" (change)="onTableSelect()"
                                class="form-select add-report-select" style="width: 100%;">
                                <option selected [ngValue]="0" disabled>اختر الجدول</option>
                                <option [ngValue]="1">شركات</option>
                                <option [ngValue]="2">استمارات</option>
                                <option [ngValue]="3">باحثين</option>
                            </select>
                        </div>
                    </div>

                    <!-- Scrollable Cards Section -->
                    <div class="d-flex overflow-auto" *ngIf="tables && tables.length > 0"
                        style="gap: 15px; white-space: nowrap; padding: 15px;">
                        <!-- Card 1 -->
                        <div class="card" *ngFor="let table of tables"
                            style="min-width: 490px; border: 1px solid #ccc;max-height: 200px;min-height: 200px;">
                            <div class="modal-header pb-0">
                                <h5 class="modal-title" id="add">{{table.arTableName}}</h5>
                            </div>
                            <div class="card-body">
                                <select class="form-select add-report-select" (change)="onFieldSelect($event, table)"
                                    style="width: 100%;">
                                    <option selected value="0" disabled>اختر الحقل</option>
                                    <ng-container *ngIf="table.enTableName == 'Companies'">
                                        <option *ngFor="let field of companyFields">{{field.name}}</option>
                                    </ng-container>
                                    <ng-container *ngIf="table.enTableName == 'Researcher'">
                                        <option *ngFor="let field of researcherFields">{{field.name}}</option>
                                    </ng-container>
                                    <ng-container *ngIf="table.enTableName == 'Sectors'">
                                        <option *ngFor="let field of sectorFields">{{field.name}}</option>
                                    </ng-container>
                                    <ng-container *ngIf="table.enTableName == 'Activities'">
                                        <option *ngFor="let field of activitiesFields">{{field.name}}</option>
                                    </ng-container>
                                    <ng-container *ngIf="table.enTableName == 'SubActivities'">
                                        <option *ngFor="let field of subActivitiesFields">{{field.name}}</option>
                                    </ng-container>
                                    <ng-container *ngIf="table.enTableName == 'Governorates'">
                                        <option *ngFor="let field of governoratesFields">{{field.name}}</option>
                                    </ng-container>
                                    <ng-container *ngIf="table.enTableName == 'Wilayats'">
                                        <option *ngFor="let field of wilayatFields">{{field.name}}</option>
                                    </ng-container>
                                </select>
                                <div class="field-container"
                                    style="padding-left: 5px; padding-top: 5px; max-height: 120px;">
                                    <div class="field-item" *ngFor="let field of table.fields; let i = index">
                                        <!-- Bind field properties to the input element -->
                                        <input type="text" class="field-input" [(ngModel)]="field.value"
                                            name="field-{{ i }}">
                                        <select style="width: 120px;" class="form-select add-report-select"
                                            [(ngModel)]="field.filter" [ngModelOptions]="{standalone: true}">
                                            <option value="" disabled>اختر الفلتر</option>
                                            <ng-container *ngIf="field.dataType !== 'String'">
                                                <option *ngFor="let filter of numberFilterItems" [ngValue]="filter.id">
                                                    {{filter.arName}}
                                                </option>
                                            </ng-container>
                                            <ng-container *ngIf="field.dataType === 'String'">
                                                <option *ngFor="let filter of stringFilterItems" [ngValue]="filter.id">
                                                    {{filter.arName}}
                                                </option>
                                            </ng-container>
                                        </select>
                                        <span style="text-align: left;" class="field-text col-2">{{field.name}}</span>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <!-- Add Button -->
                        <button (click)="openModal()"
                            style="background-color: #00af9d; border-radius: 5px; float: left; height: 30px;">
                            <i style="color: white;" class="fa fa-plus" aria-hidden="true"></i>
                        </button>
                    </div>
                    <!-- Continue with remaining fields -->
                    <h4 class="mb-3">نوع التقرير</h4>
                    <div class="form-check ps-0 d-flex radio-form me-2 col-3">
                        <input class="form-check-input" type="radio" id="haveChart" value="haveChart">
                        <label class="form-check-label" for="haveChart">يشمل رسم بيانى</label>
                        <input class="form-check-input" type="radio" id="notHaveChart" value="notHaveChart" checked>
                        <label class="form-check-label" for="notHaveChart">لا يشمل رسم بيانى</label>
                      </div>

                </div>

                <div class="modal-footer pt-0" style="border-top: none;">
                    <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-save" id="next-report-part" data-bs-toggle="modal"
                        data-bs-dismiss="modal" data-bs-target="#next-part" (click)="saveReport()">حفظ</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!--end add report modal -->

<!--start add company modal -->
<div class="modal company-modal fade" id="chooseTable" tabindex="-1" aria-labelledby="add" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-sm" style="min-width: 880px;">
        <div class="modal-content" style="width: 370px; margin: 0 auto;">
            <div class="modal-header pb-0">
                <h5 class="modal-title" id="add">اختيار من جدول فرعي</h5>
            </div>
            <form>
                <div class="modal-body">
                    <select class="form-select add-report-select" style="width: 100%;" [(ngModel)]="selectedTable"
                        [ngModelOptions]="{standalone: true}">
                        <option value="" disabled>اختر الجدول الفرعي</option>
                        <option *ngFor="let table of companyTables" [ngValue]="table">{{table.arName}}</option>
                    </select>

                </div>
                <div class="modal-footer pt-0" style="border-top: none;">
                    <button type="button" class="btn btn-cancel" (click)="closeModal()">إلغاء</button>
                    <button type="button" class="btn btn-save" (click)="appendTable()">حفظ</button>
                </div>
            </form>
        </div>
    </div>
</div>